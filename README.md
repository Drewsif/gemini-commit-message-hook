# Gemini Commit Message Hook

This project uses Google's Gemini AI to automatically generate git commit messages, because doing it by hand is annoying. AI is pretty good at this task but you should review it's output since it is an LLM and loves to make up random things.

## Example Output

Here is an example of a commit message generated by the hook for [this commit](https://github.com/Drewsif/PiShrink/commit/f3f2ecea784374a3cb349a95afb6300ac523578f):

```
This commit adds an update checking mechanism to the script and introduces a new flag to disable it. The documentation has been updated to reflect these changes.

- feat(update): Add automatic update checking on script startup
- feat(cli): Add -n flag to disable automatic update checking
- docs(readme): Update usage instructions and add documentation for the new -n flag
- fix(usage): Correct the script name to pishrink.sh in the README usage instructions
```

## Features

- Generates a 1-2 sentence summary of your changes.
- Creates a markdown list of changes in conventional commit format.
- Uses Python's standard libraries for cross-platform compatibility.
- Easy to install with a single command.
- Skips merge commits.

## Setup

1. **Clone the repository:**

    ```bash
    git clone https://github.com/Drewsif/gemini-commit-message-hook
    cd gemini-commit-msg-hook
    ```

2. **Configure your API Key:**

    Configuration is handled in the `config.py` file.

    - **Option 1: Edit `config.py` (Recommended for simplicity)**
        Open `config.py` and set the `GEMINI_API_KEY` variable to your key:

        ```python
        GEMINI_API_KEY = "YOUR_API_KEY"
        ```

    - **Option 2: Use an environment variable**
        If `GEMINI_API_KEY` in `config.py` is set to `None`, the script will look for the `GEMINI_API_KEY` environment variable.

        **macOS/Linux:**

        ```bash
        export GEMINI_API_KEY="YOUR_API_KEY"
        ```

        **Windows:**

        ```powershell
        $env:GEMINI_API_KEY="YOUR_API_KEY"
        ```

3. **Install the hook:**

    Run the installation script in the root of the repository where you want to use the hook.

    ```bash
    python install.py
    ```

    This will create a `prepare-commit-msg` hook in your repository's `.git/hooks` directory.

## Usage

Once installed, the hook will automatically run every time you make a commit. It will generate a commit message and open it in your default editor for you to review and save.

If there are no staged changes, the commit will be aborted.

### Providing a Hint

You can provide a hint to the AI by passing a message with the `-m` flag when you commit. The AI will use your message as a hint to generate a more accurate commit message (hopefully).

```bash
git commit -m "Refactor the user authentication flow"
```

## Customization

You can customize the Gemini model and other settings by editing the `config.py` file.

## Uninstallation

To remove the hook, simply delete the `prepare-commit-msg` file from your repository's `.git/hooks` directory.

```bash
rm .git/hooks/prepare-commit-msg
```

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
